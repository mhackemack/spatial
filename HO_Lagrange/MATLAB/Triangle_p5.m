% Clear Project Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear; clc; close all; fclose all;

% Define Symbolic Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
syms x y
ord = 5;
w = 1 - x - y;

% Define 1D functions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
fx1 = x;       fy1 = y;       fw14 = 1/5 - x - y;
fx2 = 1/5 - x; fy2 = 1/5 - y; fw24 = 2/5 - x - y;
fx3 = 2/5 - x; fy3 = 2/5 - y; fw34 = 3/5 - x - y;
fx4 = 3/5 - x; fy4 = 3/5 - y; fw44 = 4/5 - x - y;
fx5 = 4/5 - x; fy5 = 4/5 - y; fw55 = 1 - x - y;
fx6 = 5/5 - x; fy6 = 5/5 - y;

% Set functional forms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


xx = [0,0;...
      1,0;...
      0,1;...
      1/5,0;...
      2/5,0;...
      3/5,0;...
      4/5,0;...
      4/5,1/5;...
      3/5,2/5;...
      2/5,3/5;...
      1/5,4/5;...
      0,4/5;...
      0,3/5;...
      0,2/5;...
      0,1/5;...
      1/5,1/5;...
      3/5,1/5;...
      1/5,3/5;...
      2/5,1/5;...
      2/5,2/5;...
      1/5,2/5];

% Test Lagrange Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
b = [b1;b2;b3];
% b = [b1;b2;b3;b4;b5;b6;b7;b8;b9;b10;b11;b12;b13;b14;b15;b16;b17;b18;b19;b20;b21];

for i=1:length(b)
    for j=1:length(b)
        val_lagrange(i,j) = subs(subs(b(i),'x',xx(j,1)),'y',xx(j,2));
    end
end
sym(val_lagrange)

% Test Interpolation Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
mon = get_Pmonomials(2,ord);
for i=1:size(mon,1)
    aa = mon(i,1);
    bb = mon(i,2);
    a_sym = x^aa*y^bb;
    a_ana = simplify((xx(:,1).^aa.*xx(:,2).^bb)'*b);
    val_interp(i,:) = [a_sym,a_ana,a_sym-a_ana];
end
val_interp