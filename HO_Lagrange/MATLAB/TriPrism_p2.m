% Clear Project Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear; clc; close all; fclose all;

% Define Symbolic Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
syms x y z
ord = 2;
w = 1 - x - y;

% Set functional forms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
b1  = -w*(2*w-1)*(1-z)*(2*z-1);
b2  = -x*(2*x-1)*(1-z)*(2*z-1);
b3  = -y*(2*y-1)*(1-z)*(2*z-1);
b4  = -4*w*x*(1-z)*(2*z-1);
b5  = -4*x*y*(1-z)*(2*z-1);
b6  = -4*y*w*(1-z)*(2*z-1);
b7  = w*(2*w-1)*z*(2*z-1);
b8  = x*(2*x-1)*z*(2*z-1);
b9  = y*(2*y-1)*z*(2*z-1);
b10 = 4*w*x*z*(2*z-1);
b11 = 4*x*y*z*(2*z-1);
b12 = 4*y*w*z*(2*z-1);
b13 = 4*w*(2*w-1)*z*(1-z);
b14 = 4*x*(2*x-1)*z*(1-z);
b15 = 4*y*(2*y-1)*z*(1-z);
b16 = 16*w*x*z*(1-z);
b17 = 16*x*y*z*(1-z);
b18 = 16*y*w*z*(1-z);

% Test Lagrange Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
b = [b1;b2;b3;b4;b5;b6;b7;b8;b9;b10;b11;b12;b13;b14;b15;b16;b17;b18];

xx = [0,0,0;...
      1,0,0;...
      0,1,0;...
      1/2,0,0;...
      1/2,1/2,0;...
      0,1/2,0;...
      0,0,1;...
      1,0,1;...
      0,1,1;...
      1/2,0,1;...
      1/2,1/2,1;...
      0,1/2,1;...
      0,0,1/2;...
      1,0,1/2;...
      0,1,1/2;...
      1/2,0,1/2;...
      1/2,1/2,1/2;...
      0,1/2,1/2];

for i=1:length(b)
    for j=1:length(b)
        val_lagrange(i,j) = subs(subs(subs(b(i),'x',xx(j,1)),'y',xx(j,2)),'z',xx(j,3));
    end
end
val_lagrange

% Test Interpolation Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tri_mon = get_Pmonomials(2,ord);
mon = get_zproduct_monomials(tri_mon,ord);
for i=1:size(mon,1)
    aa = mon(i,1);
    bb = mon(i,2);
    cc = mon(i,3);
    a_sym = x^aa*y^bb*z^cc;
    a_ana = simplify((xx(:,1).^aa.*xx(:,2).^bb.*xx(:,3).^cc)'*b);
    val_interp(i,:) = [a_sym,a_ana,a_sym-a_ana];
end
val_interp
