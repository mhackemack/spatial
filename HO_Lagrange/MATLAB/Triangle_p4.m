% Clear Project Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear; clc; close all; fclose all;

% Define Symbolic Space
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
syms x y
ord = 4;
w = 1 - x - y;

% Define 

% Set functional forms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
b1  = w*(4/1*w-1)*(4/2*w-1)*(4/3*w-1);
b2  = x*(4/1*x-1)*(4/2*x-1)*(4/3*x-1);
b3  = y*(4/1*y-1)*(4/2*y-1)*(4/3*y-1);
b4  = 16/3*x*w*(4/1*w-1)*(4/2*w-1);
b5  = 4*x*w*(4/1*x-1)*(4/1*w-1);
b6  = 16/3*x*w*(4/1*x-1)*(4/2*x-1);
% b7  = 
% b8  = 
% b9  = 
% b10 = 
% b11 = 
% b12 = 
% b13 = 
% b14 = 
% b15 = 

xx = [0,0;...
      1,0;...
      0,1;...
      1/4,0;...
      2/4,0;...
      3/4,0;...
      3/4,1/4;...
      2/4,2/4;...
      1/4,3/4;...
      0,3/4;...
      0,2/4;...
      0,1/4;...
      1/4,1/4;...
      2/4,1/4;...
      1/4,2/4];

% Test Lagrange Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
b = [b1;b2;b3;b4;b5;b6];
% b = [b1;b2;b3;b4;b5;b6;b7;b8;b9;b10;b11;b12;b13;b14;b15];

for i=1:length(b)
    for j=1:length(b)
        val_lagrange(i,j) = subs(subs(b(i),'x',xx(j,1)),'y',xx(j,2));
    end
end
sym(val_lagrange)

% Test Interpolation Property
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% mon = get_Pmonomials(2,ord);
% for i=1:size(mon,1)
%     aa = mon(i,1);
%     bb = mon(i,2);
%     a_sym = x^aa*y^bb;
%     a_ana = simplify((xx(:,1).^aa.*xx(:,2).^bb)'*b);
%     val_interp(i,:) = [a_sym,a_ana,a_sym-a_ana];
% end
% val_interp